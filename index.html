<!DOCTYPE html>
<html lang="en-GB">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="The Just Chatting Twitch and Youtube Live alternative live streaming service">
    <title>Spiel - Live Streaming</title>
    <meta property="og:title" content="Spiel - Live Streaming" />
    <meta property="og:description" content="The Just Chatting Twitch Youtube Live alternative live streaming service" />
    <meta property="og:image" content="" />
    <link href="style.css" rel="stylesheet" type="text/css" />
    <script src="./app.js" ></script>
    <script src="https://cdn.jsdelivr.net/npm/gun/gun.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gun/sea.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/QVDev/GunStreamer@0.0.9/js/GunRecorder.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/QVDev/GunStreamer@0.0.9/js/GunStreamer.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/QVDev/GunStreamer@0.0.9/js/GunViewer.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/QVDev/GunStreamer@0.0.9/js/mediabuffer.js"></script>
  </head>
  <body id="app">
    <header>
      <div>
        <h1>Spiel</h1>
      </div>
      <div>
        <nav>
          <div>
            <ul>
              <li><button onclick="window.location.search = 'content=home'">Home</button></li>
              <li><button onclick="window.location.search = 'content=live'">Live</button></li>
              <li><button onclick="window.location.href = 'https://github.com/BrendanDN/Spiel#guides'">Guides</button></li>
              <li><button onclick="window.location.href = 'https://github.com/BrendanDN/Spiel#support'">Support</button></li>
            </ul>
          </div>
          <hr>
          <div id="auth"></div>
        </nav>
      </div>
    </header>
    <script>
      //Configure GUN to pass to streamer
      const gun = Gun();
      let user = gun.user().recall({sessionStorage: true});

      const urlParams = new URLSearchParams(window.location.search);
      const content = urlParams.get('content');

      if (!urlParams.has('content')) {
        window.location.search = 'content=home';
      }
      
      function signout() {
        try {
          user.leave();
          location.reload();
        } catch(err) {
          alert(err);
        }
      }
      
      if (user.is) {
        document.getElementById("auth").innerHTML = `
          <ul>
            <li><button onclick="signout()">Sign Out</button></li>
          </ul>
        `;

        switch(content) {
        case 'watch':
          document.write(watch);
          break;
        case 'signin':
          document.write(home);
          break;
        case 'signup':
          document.write(home);
          break;
        case 'live':
          document.write(live);
          break;
        case 'home':
          document.write(home);
          break;
        default:
          document.write(err404)
        }
      } else {
        document.getElementById("auth").innerHTML = `
          <ul>
            <li><button onclick="window.location.search = 'content=signin'">Sign In</button></li>
            <li><button onclick="window.location.search = 'content=signup'">Sign Up</button></li>
          </ul>
        `;

        switch(content) {
        case 'watch':
          document.write(watch);
          break;
        case 'signin':
          document.write(signin);
          break;
        case 'signup':
          document.write(signup);
          break;
        case 'live':
          document.write(signin);
          break;
        case 'home':
          document.write(home);
          break;
        default:
          document.write(err404)
        }
      }
    </script>
    <footer>
      <pre><b>Spiel</b></pre>
      <button onclick="window.location.href = 'https://github.com/BrendanDN/Spiel#support-us'">Donate</button>
    </footer>
  </body>
</html>
