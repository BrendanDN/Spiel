<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <title>ivecodestream</title>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="shortcut icon" href="../images/icons/favicon.ico">
    <script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gun/sea.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/QVDev/GunStreamer@0.0.9/js/GunViewer.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/QVDev/GunStreamer@0.0.9/js/mediabuffer.js"></script>
</head>

<body>
  <header>
    <div class="center">
      <button onclick="window.location.href = '/'">Home</button>
    </div>
  </header>
  <main>
      <div class="container">
        <H1 id="user_stream" style="display:inline"></H1>
        <H1 id="stream_count" style="display:inline"></H1>
        <video id="video" width="60%" height="33.75%" data-role="video"
          data-poster="https://mir-s3-cdn-cf.behance.net/project_modules/1400_opt_1/fe186655756437.5992117fb6ee1.gif"
          data-logo="../images/logo.png" data-logo-height="25" data-logo-target="https://metroui.org.ua/v4/"
          data-volume=".0" data-show-loop="false" data-show-stop="false" data-show-play="false"
          data-show-pause="false" data-show-stream="false" controls></video>
        <div>
          <pre>Chat: </pre>
          <p id="chat"></p>
          <div class="container">
            <button onclick="sentMessage('üòÉ')">üòÉ</button>
            <button onclick="sentMessage('ü§£')">ü§£</button>
            <button onclick="sentMessage('üòê')">üòê</button>
            <button onclick="sentMessage('üò¶')">üò¶</button>
          </div>
        </div>
      </div>
  </main>
  <script src="js/stores.js"></script>
  <script src="js/components.js" defer></script>
  <script src="js/messages.js"></script>
  <script>
    //Change to correct id
    document.getElementById("user_stream").innerHTML = "You're watching <b>#" + STREAM_ID + "'s</b> stream"
    document.getElementById("video").id = STREAM_ID;

    //Configure GunViewer 
    var viewer_config = {
      mimeType: MIME_TYPE_USE,
      streamerId: STREAM_ID,//ID of the streamer
      catchup: false,//Skip to last frame when there is to much loading. Set to false to increase smooth playback but with latency
      debug: false,//For debug logs  
    }

    var gunViewer = new GunViewer(viewer_config);

    // Get data from gun and pass along to viewer
    gunDB.get(STREAM_ID).on(function (data) {
      gunViewer.onStreamerData(data);
    });
  </script>
  <f-t></f-t>
</body>

</html>