<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Spiel-Studio</title>
  <meta property="og:title" content="Spiel-Studio" />
  <meta property="og:description" content="The Just Chatting Twitch Youtube Live alternative live streaming service" />
  <meta property="og:image" content="" />
  <meta name="theme-color" content="#49cab0"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="#49cab0" />
  <link rel="icon" href="img/icons/maskable_icon_x128.png">
  <link rel="apple-touch-icon" href="img/icons/maskable_icon_x128.png">
  <link href="manifest.json" rel="manifest" />
  <script src="https://cdn.jsdelivr.net/npm/gun/gun.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gun/sea.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/QVDev/GunStreamer/js/GunStreamer.js"></script>
</head>

<body>
  <!-- <h1 id="intro" style="font-family: Arial; text-align: center;">Welcome to broadcast studio
    <br>click anywhere to start</h1> -->
  <section></section>
  <dialog id="shareDialog">
    <ul>
      <li><a id="facebook" href="" target="_blank">Facebook</a></li>
      <li><a id="whatsapp" href="" target="_blank">WhatsApp</a></li>
      <li><a id="weibo" href="">Weibo</a></li>
      <li><a id="twitter" href="">Twitter</a></li>
      <li><a id="reddit" href="">Reddit</a></li>
      <div class="center">
        <button onclick="document.getElementById('shareDialog').close()">Close</button>
      </div>
    </ul>
  </dialog>
</body>
<script src="js/wbs.js"></script>
<script src="js/stores.js"></script>
<script src="js/studio.js"></script>
<script>
  if (user.is) {
    //Config for the GUN GunStreamer
    var streamer_config = {
      dbRecord: "gunmeeting",//The root of the streams
      streamId: STREAM_ID,//The user id you wanna stream  
      gun: gunDB,//Gun instance
      debug: false,//For debug logs    
      url: "https://cdn.jsdelivr.net/gh/QVDev/GunStreamer@0.0.9/js/parser_worker.js"//webworker load remote
    }

    //GUN Streamer is the data side. It will convert data and write to GUN db
    const gunStreamer = new GunStreamer(streamer_config)

    const OPTS = {
      output: {
        width: 1280,  // resolution of the output stream
        height: 720,
        fps: 24       // frames per second of the output stream
      },
      injectStyles: true // whether to inject the WBS css
    }
    
    var wbs = new WBS('section', [OPTS])

    wbs.on('stream', function (stream) {
      console.log("received stream " + stream)
      startRecording(stream);
    })
    wbs.on('stopstream', function () {
      stopRecording();
      console.log("Stopped streaming");
    })
  } else {
    window.location.href = "auth.html?auth=signin"
  }
</script>
</html>